<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>美摄SDK For Android: 快速接入指南</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">美摄SDK For Android
   &#160;<span id="projectnumber">3.13.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">快速接入指南 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Effect中间层使用说明</h1>
<hr  />
<p>NveEffectKit集成了美颜、美型、美妆、妆容、滤镜、人脸道具功能。依赖库为3.8.0以上的美摄Effect库</p>
<h2>导入项目</h2>
<p>Android打包为AAR库，复制到libs目录下，在build.gradle设置aar的编译引入</p>
<div class="fragment"><div class="line">api fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;, &#39;*.aar&#39;])</div>
</div><!-- fragment --><h2>SDK授权</h2>
<p>需要传入授权文件路径，该路径可以是assets下路径，或者本地的绝对路径</p>
<div class="fragment"><div class="line"> </div>
<div class="line">String licPath = <span class="stringliteral">&quot;assets:/effectsdkdemo.lic&quot;</span>;</div>
<div class="line">NveEffectKit.getInstance().init(<span class="keyword">this</span>, licPath);</div>
</div><!-- fragment --><h2>初始化人脸检测模型</h2>
<p>初始化模型，需传入模型类型和路径（路径可以为assets路径或本地绝对路径）</p>
<div class="fragment"><div class="line"> </div>
<div class="line">NveEffectKit.getInstance().initModel(<span class="keyword">this</span>, NveDetectionModelType.FACE, faceModelPath);</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">类型 </th><th class="markdownTableHeadLeft">名称 </th><th class="markdownTableHeadNone">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveDetectionModelType.FACE </td><td class="markdownTableBodyLeft">人脸 </td><td class="markdownTableBodyNone">人脸道具使用  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveDetectionModelType.FAKE_FACE </td><td class="markdownTableBodyLeft">假脸 </td><td class="markdownTableBodyNone">人脸道具使用  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveDetectionModelType.MAKEUP2 </td><td class="markdownTableBodyLeft">美妆 </td><td class="markdownTableBodyNone">妆容和单妆使用  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveDetectionModelType.EYEBALL </td><td class="markdownTableBodyLeft">眼球 </td><td class="markdownTableBodyNone">部分人脸道具会用到眼球效果  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveDetectionModelType.SEGMENTATION </td><td class="markdownTableBodyLeft">背景分割 </td><td class="markdownTableBodyNone">部分人脸道具会用到分割效果  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveDetectionModelType.AVATAR </td><td class="markdownTableBodyLeft">avatar </td><td class="markdownTableBodyNone">根据表情动的特效果类别会使用这个模型  </td></tr>
</table>
<h2>美颜使用</h2>
<div class="fragment"><div class="line"><span class="comment">//美颜的使用</span></div>
<div class="line">NveBeauty beauty= <span class="keyword">new</span> NveBeauty();</div>
<div class="line">beauty.setEnable(<span class="keyword">true</span>);</div>
<div class="line"><span class="comment">//磨皮和美白有多种类型，默认类型如下</span></div>
<div class="line">beauty.setBlurType(NveBeautyBlurTypeEnum.AdvancedBuffingSkin1);</div>
<div class="line">beauty.setWhiteningType(NveBeautyWhiteningTypeEnum.WhiteningA);</div>
<div class="line"><span class="comment">//只设置一次即可，后续修改参数可直接调用beauty的参数set方法。</span></div>
<div class="line"><span class="comment">//开关可以通过enable参数控制</span></div>
<div class="line">NveEffectKit.getInstance().setBeauty(beauty);</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">参数 </th><th class="markdownTableHeadNone">类型 </th><th class="markdownTableHeadNone">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">enable </td><td class="markdownTableBodyNone">boolean </td><td class="markdownTableBodyNone">美颜功能开关  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">blurType </td><td class="markdownTableBodyNone">NveBeautyBlurTypeEnum </td><td class="markdownTableBodyNone">磨皮类型  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">blurIntensity </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">磨皮强度，[0-1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">whiteningType </td><td class="markdownTableBodyNone">NvBeautyWhiteningTypeEnum </td><td class="markdownTableBodyNone">美白类型  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">whiteningIntensity </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">美白强度，[0-1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">matteIntensity </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">去油光强度，[0-1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">matteFillRadius </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">去油光半径，[0-1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">reddeningIntensity </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">红润强度，[0-1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">definitionIntensity </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">清晰度强度，[0-1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">sharpnessIntensity </td><td class="markdownTableBodyNone">float </td><td class="markdownTableBodyNone">锐度强度，[0-10]  </td></tr>
</table>
<p>磨皮类型</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadNone">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveBeautyBlurTypeEnum.BuffingSkin </td><td class="markdownTableBodyNone">普通磨皮  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveBeautyBlurTypeEnum.AdvancedBuffingSkin1 </td><td class="markdownTableBodyNone">高级磨皮1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveBeautyBlurTypeEnum.AdvancedBuffingSkin2 </td><td class="markdownTableBodyNone">高级磨皮2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveBeautyBlurTypeEnum.AdvancedBuffingSkin3 </td><td class="markdownTableBodyNone">高级磨皮3  </td></tr>
</table>
<p>美白类型</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadNone">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvBeautyWhiteningTypeEnum.WhiteningA </td><td class="markdownTableBodyNone">美白A  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvBeautyWhiteningTypeEnum.WhiteningB </td><td class="markdownTableBodyNone">美白B  </td></tr>
</table>
<h2>美型使用</h2>
<div class="fragment"><div class="line"><span class="comment">//使用美型</span></div>
<div class="line">NveShape shape= <span class="keyword">new</span> NveShape();</div>
<div class="line">shape.setEnable(<span class="keyword">true</span>);</div>
<div class="line">NveEffectKit.getInstance().setShape(shape);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//新增美型，分别传入类型，shapeDegree:美型强度[-1,1]，</span></div>
<div class="line"><span class="comment">//shapePackageID：美型包ID(包需要安装,安装见下面安装使用)</span></div>
<div class="line">shape.setShapeData(NveShapeTypeEnum,<span class="keyword">new</span> NveShapeData(shapeDegree,shapePackageID));</div>
<div class="line"><span class="comment">//修改美型强度</span></div>
<div class="line">shape.setDegreeByType(NveShapeTypeEnum, value);</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadNone">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveShapeTypeEnum.FACE_WIDTH </td><td class="markdownTableBodyNone">窄脸，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveShapeTypeEnum.FACE_LENGTH </td><td class="markdownTableBodyNone">小脸，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveShapeTypeEnum.FACE_SIZE </td><td class="markdownTableBodyNone">瘦脸，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveShapeTypeEnum.FORE_HEAD </td><td class="markdownTableBodyNone">额头，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveShapeTypeEnum.CHIN </td><td class="markdownTableBodyNone">下巴，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveShapeTypeEnum.EYE_SIZE </td><td class="markdownTableBodyNone">大眼，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveShapeTypeEnum.EYE_ANGLE </td><td class="markdownTableBodyNone">眼角，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveShapeTypeEnum.NOSE_WIDTH </td><td class="markdownTableBodyNone">瘦鼻，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveShapeTypeEnum.NOSE_LENGTH </td><td class="markdownTableBodyNone">长鼻，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveShapeTypeEnum.MOUTH_SIZE </td><td class="markdownTableBodyNone">嘴型，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveShapeTypeEnum.MOUTH_CORNER </td><td class="markdownTableBodyNone">嘴角，[-1,1]  </td></tr>
</table>
<h2>微整形使用</h2>
<div class="fragment"><div class="line"><span class="comment">//使用微整形</span></div>
<div class="line">NveMicroShape microShape = <span class="keyword">new</span> NveMicroShape();</div>
<div class="line">microShape.setEnable(<span class="keyword">true</span>);</div>
<div class="line">NveEffectKit.getInstance().setMicroShape(microShape);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//新增微整形，分别传入类型，shapeDegree:微整形强度，</span></div>
<div class="line"><span class="comment">//shapePackageID：微整形ID(包需要安装,安装见下面安装使用)</span></div>
<div class="line">shape.setMicroShapeData(NveMicroShapeTypeEnum, <span class="keyword">new</span> NveMicroShapeData(shapeDegree,shapePackageID));</div>
<div class="line"><span class="comment">//修改微整形强度</span></div>
<div class="line">shape.setDegreeByType(NveMicroShapeTypeEnum, value);</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadCenter">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.HEAD_SIZE </td><td class="markdownTableBodyCenter">缩头，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.CHEEKBONE_WIDTH </td><td class="markdownTableBodyCenter">颧骨宽，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.JAW_WIDTH </td><td class="markdownTableBodyCenter">下颌宽，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.TEMPLE_WIDTH </td><td class="markdownTableBodyCenter">太阳穴宽，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.NASOLABIAL_FOLDS </td><td class="markdownTableBodyCenter">法令纹，[0,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.DARK_CIRCLES </td><td class="markdownTableBodyCenter">黑眼圈，[0,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.BRIGHTEN_EYES </td><td class="markdownTableBodyCenter">亮眼，[0,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.WHITEN_TEETH </td><td class="markdownTableBodyCenter">美牙，[0,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYE_ANGLE_DEGREE </td><td class="markdownTableBodyCenter">眼角度，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYE_DISTANCE </td><td class="markdownTableBodyCenter">眼离，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYE_HEIGHT </td><td class="markdownTableBodyCenter">眼高度，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYE_WIDTH </td><td class="markdownTableBodyCenter">眼宽度，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYE_ARC </td><td class="markdownTableBodyCenter">眼弧度，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYE_Y_OFFSET </td><td class="markdownTableBodyCenter">眼上下，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.PHILTRUM </td><td class="markdownTableBodyCenter">人中，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.NOSE_BRIDGE_WIDTH </td><td class="markdownTableBodyCenter">鼻梁宽度，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.NOSE_HEAD </td><td class="markdownTableBodyCenter">鼻头，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYEBROW_THICKNESS </td><td class="markdownTableBodyCenter">眉毛粗细，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYEBROW_ANGLE </td><td class="markdownTableBodyCenter">眉角度，[-1,1]  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYEBROW_Y_OFFSET </td><td class="markdownTableBodyCenter">眉上下，[-1,1]  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NvMicroShapeTypeEnum.EYEBROW_X_OFFSET </td><td class="markdownTableBodyCenter">眉间距，[-1,1]  </td></tr>
</table>
<blockquote class="doxtable">
<p><a href="https://www.meishesdk.com/android/doc_ch/html/content/FxNameList_8md.html">美摄SDK For Android: 特效名称列表 (meishesdk.com)</a> </p>
</blockquote>
<p>美颜、美型、微整形的各个参数均来自于美摄文档仓库中AR Scene的说明，更多进阶用法见上方链接。</p>
<hr  />
<h2>美妆</h2>
<div class="fragment"><div class="line"><span class="comment">//使用美妆</span></div>
<div class="line">NveMakeup makeUp= <span class="keyword">new</span> NveMakeup();</div>
<div class="line">makeUp.setEnable(<span class="keyword">true</span>);</div>
<div class="line">NveEffectKit.getInstance().setMakeup(makeUp);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//新增美妆中的单妆，NvSingleMakeUp来自单妆包中解析的makeup.json</span></div>
<div class="line"><span class="comment">//(包需要安装,安装见下面安装使用)</span></div>
<div class="line">makeUp.addSingleMakeUp(NveMakeupTypeEnum, NveSingleMakeUp);</div>
<div class="line"><span class="comment">//根据单妆类型删除使用的单妆，每个类型的单妆只能加一个，例如只能加一种类型的口红。            </span></div>
<div class="line">makeUp.removeSingleMakeUp(NveMakeupTypeEnum);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//妆容的使用，NvComposeMakeup来自妆容包中解析的info.json</span></div>
<div class="line"><span class="comment">//(包需要安装,安装见下面安装使用)</span></div>
<div class="line">makeUp.setComposeMakeup(NveComposeMakeup);</div>
<div class="line"><span class="comment">//妆容的删除。妆容是由多个单妆、美颜、美型、微整形、滤镜等组成，每次只能应用一个妆容</span></div>
<div class="line">makeUp.removeComposeMakeUp();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//调节单妆强度</span></div>
<div class="line">makeUp.setIntensityByType(NveMakeupTypeEnum.Brighten,1);</div>
<div class="line"><span class="comment">//调节单妆颜色</span></div>
<div class="line">makeUp.setColorByType(NveMakeupTypeEnum.Brighten,<span class="keyword">new</span> NvsColor(0,0,0,0));</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadNone">用途  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Lip </td><td class="markdownTableBodyNone">口红  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Eyebrow </td><td class="markdownTableBodyNone">眉毛  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Eyeshadow </td><td class="markdownTableBodyNone">眼影  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Eyelash </td><td class="markdownTableBodyNone">睫毛  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Eyeliner </td><td class="markdownTableBodyNone">眼线  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Blusher </td><td class="markdownTableBodyNone">腮红  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Shadow </td><td class="markdownTableBodyNone">修容  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.Brighten </td><td class="markdownTableBodyNone">高光  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveMakeupTypeEnum.ComposeMakeup </td><td class="markdownTableBodyNone">妆容  </td></tr>
</table>
<h2>滤镜</h2>
<div class="fragment"><div class="line"><span class="comment">//必传ID，包滤镜需安装，传入安装后的ID(安装见下面安装使用)</span></div>
<div class="line">NveFilter filter = <span class="keyword">new</span> NveFilter(effectId);</div>
<div class="line">NveEffectKit.getInstance().addFilter(filter);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//setFilter表示使用滤镜，后续可以进行其他修改参数操作，例如修改强度：</span></div>
<div class="line">filter.setFilterIntensity(0.5f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//移除滤镜</span></div>
<div class="line">NveEffectKit.getInstance().removeFilter(filter);</div>
</div><!-- fragment --><h2>道具</h2>
<div class="fragment"><div class="line">NveFaceProp faceProp = <span class="keyword">new</span> NveFaceProp();</div>
<div class="line">faceProp.setEnable(<span class="keyword">true</span>);</div>
<div class="line"><span class="comment">//设置道具Id(道具包需要安装,安装见下面安装使用)</span></div>
<div class="line">faceProp.setPropId(propId);</div>
<div class="line">NveEffectKit.getInstance().setFaceProp(faceProp);</div>
</div><!-- fragment --><hr  />
<h2>自定义特效</h2>
<p>NveEffectKit除了上述已有功能，用户可自已创建美摄支持的特效，使用中间层来渲染。比如背景分割功能（需提前初始化人脸和分割模型），实现如下：</p>
<div class="fragment"><div class="line"><span class="comment">//创建背景分割</span></div>
<div class="line">NvsRational aspectRatio = <span class="keyword">new</span> NvsRational(9, 16);</div>
<div class="line">NvsVideoEffect mSegmentationEffect = NvsEffectSdkContext.getInstance().createVideoEffect(<span class="stringliteral">&quot;Segmentation Background Fill&quot;</span>, aspectRatio);</div>
<div class="line">mSegmentationEffect.setIntVal(<span class="stringliteral">&quot;Stretch Mode&quot;</span>, 2);</div>
<div class="line">mSegmentationEffect.setMenuVal(<span class="stringliteral">&quot;Segment Type&quot;</span>, <span class="stringliteral">&quot;Half Body&quot;</span>);</div>
<div class="line">mSegmentationEffect.setColorVal(<span class="stringliteral">&quot;Background Color&quot;</span>, <span class="keyword">new</span> NvsColor(0, 1, 0, 1));</div>
<div class="line"> </div>
<div class="line"><span class="comment">//添加渲染</span></div>
<div class="line">NveEffectKit.getInstance().addEffect(mSegmentationEffect);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//根据索引添加渲染</span></div>
<div class="line">NveEffectKit.getInstance().insertEffect(mSegmentationEffect,0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//移除创建的特效</span></div>
<div class="line">NveEffectKit.getInstance().removeEffect(mSegmentationEffect);</div>
</div><!-- fragment --><hr  />
<h2>包安装</h2>
<p>上述的内容中基本都涉及包安装，官网有安装说明</p>
<blockquote class="doxtable">
<p><a href="https://www.meishesdk.com/android/doc_ch/html/content/assetsPackageInstall_8md.html">美摄SDK For Android: 素材包安装 (meishesdk.com)</a> </p>
</blockquote>
<p>可以使用已经封装好的工具类（NvAssetPackageManagerUtil）示例代码：</p>
<div class="fragment"><div class="line">NveAssetPackageManagerUtil.installFxPackage(packagePath, packageLicPath, packageType);</div>
</div><!-- fragment --><p>其中需要重点关注的参数有：</p>
<p>1、packagePath&ndash; 安装包的路径，可以为assets路径或者本地绝对路径</p>
<p>2、packageLicPath&ndash; 安装包的授权文件路径</p>
<p>3、packageType&ndash; 安装包类型，具体类型见：<a href="https://www.meishesdk.com/android/doc_ch/html/content/classcom_1_1meicam_1_1sdk_1_1NvsAssetPackageManager.html">美摄SDK For Android: com.meicam.sdk.NvsAssetPackageManager类 参考 (meishesdk.com)</a></p>
<hr  />
<h2>渲染</h2>
<h5>1.RenderCore相关初始化</h5>
<div class="fragment"><div class="line"><span class="comment">//注：需提前初始化SDK</span></div>
<div class="line">NveEffectKit.getInstance().initialize();</div>
</div><!-- fragment --><h5>2.NveRenderInput说明</h5>
<p>NveRenderInput主要包括渲染配置（NveRenderConfig），纹理（NveTexture），Buffer（NveImageBuffer），图像的格式（pixelFormat）。具体参数如下：</p>
<p>（1）NveRenderConfig相关参数，包括相机朝向（cameraOrientation）和渲染模式（NveRenderMode）</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">NveRenderMode </th><th class="markdownTableHeadNone">说明  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveRenderConfig.NveRenderMode.TEXTURE_TEXTURE </td><td class="markdownTableBodyNone">纹理入，纹理出  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveRenderConfig.NveRenderMode.BUFFER_TEXTURE </td><td class="markdownTableBodyNone">Buffer入，纹理出  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveRenderConfig.NveRenderMode.BUFFER_BUFFER </td><td class="markdownTableBodyNone">Buffer入，Buffer出  </td></tr>
</table>
<p>（2）NveTexture相关参数</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">参数 </th><th class="markdownTableHeadNone">说明  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">textureId </td><td class="markdownTableBodyNone">纹理ID  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">mirror </td><td class="markdownTableBodyNone">是否水平翻转，OES纹理转Texture 2D纹理需要  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveSize </td><td class="markdownTableBodyNone">纹理宽高  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveTextureType </td><td class="markdownTableBodyNone">纹理类型  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveTextureLayout </td><td class="markdownTableBodyNone">纹理方向  </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">NveTextureType </th><th class="markdownTableHeadNone">说明  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveTextureType.NV_COMMON_TEXTURE </td><td class="markdownTableBodyNone">普通纹理  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveTextureType.NV_OES_TEXTURE </td><td class="markdownTableBodyNone">OpenGL OES纹理  </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">NveTextureLayout </th><th class="markdownTableHeadNone">说明  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveTextureLayout.UP_SIDE_DOWN </td><td class="markdownTableBodyNone">上下颠倒  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveTextureLayout.DOWN_SIDE_UP </td><td class="markdownTableBodyNone">正常  </td></tr>
</table>
<p>（3）NveImageBuffer相关参数</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadNone">说明  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">data </td><td class="markdownTableBodyNone">Buffer数据  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveSize </td><td class="markdownTableBodyNone">Buffer宽高  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mirror </td><td class="markdownTableBodyNone">是否水平翻转  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">displayRotation </td><td class="markdownTableBodyNone">当前图像需要旋转的角度  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">rowPitchY </td><td class="markdownTableBodyNone">图像每行在Frame中占的字节数，如果图像格式是NV21,YUV420, 则指Y平面  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">rowPitchUV </td><td class="markdownTableBodyNone">图像每行在Frame中占的字节数 一般是指UV平面,如果格式为RGBA,这个量没有意义  </td></tr>
</table>
<p>（4）pixelFormat图像格式，其封装在NvFormatType中，具体对应可参考官网<a href="[美摄SDK For Android: com.meicam.sdk.NvsVideoFrameInfo类 参考](https://www.meishesdk.com/android/doc_ch/html/content/classcom_1_1meicam_1_1sdk_1_1NvsVideoFrameInfo.html#a879ad4bf8e42df9381768f5aff2693c8)">视频帧像素格式</a></p>
<h5>3.NveRenderOutput说明</h5>
<p>NveRenderOutput主要包括渲染结果（NveRenderError），输出纹理（NveTexture，参数同上），输出Buffer（NveImageBuffer，参数同上）。其渲染结果参数如下</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">名称 </th><th class="markdownTableHeadNone">说明  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveRenderError.NO_ERROR </td><td class="markdownTableBodyNone">成功  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveRenderError.ERROR_UNKNOWN </td><td class="markdownTableBodyNone">未知错误  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NveRenderError.INVALID_TEXTURE </td><td class="markdownTableBodyNone">无效的纹理  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NveRenderError.INVALID_INPUT_PARAM </td><td class="markdownTableBodyNone">无效的输入参数，针对NvRenderInput  </td></tr>
</table>
<h4>4.渲染</h4>
<div class="fragment"><div class="line"><span class="comment">//输入配置</span></div>
<div class="line">NveRenderInput  mRenderInput = <span class="keyword">new</span> NveRenderInput();</div>
<div class="line">mRenderInput.setPixelFormat(NveFormatType.VIDEO_FRAME_PIXEL_FROMAT_NV21.getType());</div>
<div class="line">NveRenderConfig config = <span class="keyword">new</span> NveRenderConfig()</div>
<div class="line">                .setRenderMode(NveRenderConfig.NveRenderMode.TEXTURE_TEXTURE)</div>
<div class="line">                .setCameraOrientation(mCameraProxy.getOrientation()).build();</div>
<div class="line">mRenderInput.setConfig(config);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//输入纹理</span></div>
<div class="line">NveTexture nvTexture = <span class="keyword">new</span> NveTexture();</div>
<div class="line">nvTexture.setTextureId(displayTex);</div>
<div class="line">Texture.setTextureType(NveTextureType.NV_OES_TEXTURE);</div>
<div class="line">nvTexture.setSize(<span class="keyword">new</span> NveSize(texWidth, texHeight));</div>
<div class="line">nvTexture.setMirror(mCameraProxy.isFlipHorizontal());</div>
<div class="line">mRenderInput.setTexture(nvTexture);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//输入Buffer</span></div>
<div class="line">NveImageBufferbuffer = <span class="keyword">new</span> NveImageBuffer();</div>
<div class="line">buffer.setData(data);</div>
<div class="line">buffer.setSize(<span class="keyword">new</span> NveSize(bufferWidth, bufferHeight));</div>
<div class="line">buffer.setDisplayRotation(mOrientation);</div>
<div class="line">buffer.setMirror(mCameraProxy.isFlipHorizontal());</div>
<div class="line">mRenderInput.setImageBuffer(buffer);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//渲染</span></div>
<div class="line">NveRenderOutput renderOutput = mNvEffectKit.renderEffect(mRenderInput);</div>
<div class="line"> </div>
<div class="line">  ......</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">null</span> != renderOutput) {</div>
<div class="line">     <span class="comment">//回收render out</span></div>
<div class="line">     NveEffectKitt.recycleOutput(renderOutput);</div>
<div class="line">}</div>
</div><!-- fragment --><h4>5.资源释放</h4>
<p>在退出或者不再需要渲染时，需要释放相关资源，可调用下面的方法</p>
<div class="fragment"><div class="line">NveEffectKit.getInstance().cleanUp();</div>
</div><!-- fragment --><p>注意：该方法需要在GLContext所在的线程调用</p>
<h2>销毁</h2>
<p>在页面退出或者应用杀死的情况下进行SDK的销毁，可调用下面的方法</p>
<div class="fragment"><div class="line">NveEffectKit.getInstance().destroy();</div>
</div><!-- fragment --><p>注意：如果是在某个页面退出时进行销毁，那么在其他地方还需要使用SDK，那么在使用前就需要重新初始化SDK，即调用init方法 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
