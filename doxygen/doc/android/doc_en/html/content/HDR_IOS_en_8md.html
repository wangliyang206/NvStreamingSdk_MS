<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeiCam SDK For Android: HDR</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MeiCam SDK For Android
   &#160;<span id="projectnumber">3.13.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">HDR </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>HDR</h1>
<h2>HDR related instructions:</h2>
<p>Meishe SDK supports the import, edit and export of HDR video, that is, the whole process of HDR video processing. Compared with ordinary SDR video processing, special settings are required in the following steps:</p>
<p>Initialize SDK, create timeline, set liveWindow display, export HDR.</p>
<h2>Get native HDR support capabilities:</h2>
<p>The HDR support capability of the machine can be obtained through the getEngineHDRCaps() interface on the NvsStreamingContext class. The meaning of the return value is as follows:</p>
<pre class="fragment">/*! \anchor  NvsHDRCapabilityFlag */
/*!
*  \if ENGLISH
*   @name HDR capability flags
*  \else
*   
*  \endif
*/
typedef enum {
    NvsHDRCapabilityFlagSupportedByImporter = 1,      //!&lt; \if ENGLISH Support importing HDR video  \else  \endif
    NvsHDRCapabilityFlagSupportedByEditing = 2,       //!&lt; \if ENGLISH Editing Support HDR  \else  \endif
    NvsHDRCapabilityFlagSupportedByExporter = 4,      //!&lt; \if ENGLISH Support exporting HDR video  \else  \endif
    NvsHDRCapabilityFlagSupportedByLivewindow = 8,    //!&lt; \if ENGLISH Livewindow support HDR \else  \endif
}NvsHDRCapabilityFlag;
</pre><h2>1、Create timeline：</h2>
<p>To create a timeline, you need to call the method: </p><pre class="fragment">- (NvsTimeline *)createTimeline:(NvsVideoResolution *)videoEditRes videoFps:(NvsRational *)videoFps audioEditRes:(NvsAudioResolution *)audioEditRes bitDepth:(NvsVideoResolutionBitDepth)depth flags:(int)flags;
</pre><p>When creating a timeline, you need to specify the bitDepth attribute of NvsVideoResolution, which has 3 parameters: </p><pre class="fragment">typedef enum NvsVideoResolutionBitDepth{
    NvsVideoResolutionBitDepth_8Bit,            //!&lt; \if ENGLISH The bit depth of processing pixel is 8bit \else   \endif
    NvsVideoResolutionBitDepth_16Bit_Float,    //!&lt; \if ENGLISH The bit depth of processing pixel is half float \else   \endif
    NvsVideoResolutionBitDepth_Auto           //!&lt; \if ENGLISH The bit depth of processing pixel is adaptive. For example, for videos with HDR in editing, half precision floating point will be used for HDR video processing in SDK \else   \endif
} NvsVideoResolutionBitDepth;
</pre><h2>2、Set livewindow：</h2>
<p>Livewindow has 3 hdr support modes, which can be configured through hdrDisplayMode property: </p><pre class="fragment">typedef enum {
    NvsLiveWindowHDRDisplayMode_SDR = 0,                //!&lt; \if ENGLISH Forced to use SDR display, regardless of whether the device supports HDR display. \else  \endif
    NvsLiveWindowHDRDisplayMode_Device ,                 //!&lt; \if ENGLISH If the device supports HDR, use HDR display. \else  \endif
    NvsLiveWindowHDRDisplayMode_TONE_MAP_SDR ,      //!&lt; \if ENGLISH If the device supports HDR, use HDR display, and use NO HDR mode display if it is not supported. \else  \endif
} NvsLiveWindowHDRDisplayMode; 
</pre><h2>3. Generate configuration:</h2>
<p>To support HDR export by configuring compileConfigurations, two parameters need to be set:</p>
<p>Example: </p><pre class="fragment">[[NvsStreamingContext sharedInstance].compileConfigurations setValue:@”hevc” forKey:NVS_COMPILE_VIDEO_ENCODEC_NAME];
[[NvsStreamingContext sharedInstance].compileConfigurations setValue:@”hlg” forKey:NVS_COMPILE_HDR_VIDEO_COLOR_TRANSFER];
</pre><h2>4、Color gain processing</h2>
<p>Adjust the color gain when converting from SDR to HDR, default: 0. </p><pre class="fragment">/*! \if ENGLISH
*  \brief Sets the color gain during SDR to HDR conversion.
*  \param gain color gain. range is [1.0, 10.0]
*  \else
*  \brief 
*  \param 
*  \endif
*  \since 2.23.0
*  \sa getColorGainForSDRToHDR
*/
- (void)setColorGainForSDRToHDR:(float)gain;

/*! \if ENGLISH
*  \brief gets the color gain during SDR to HDR conversion.
*  \return Returns color gain. range is [1.0, 10.0]
*  \else
*  \brief 
*  \return 
*  \endif
*  \since 2.23.0
*  \sa setColorGainForSDRToHDR
*/
- (float)getColorGainForSDRToHDR;
</pre><p>Recording parameters and exporting parameters：NVS_RECORD_VIDEO_ENCODEC_NAME，NVS_RECORD_HDR_VIDEO_COLOR_TRANSFER.</p>
<h2>Other:</h2>
<p>There are several types of media formats: SDR, HDR, HDR10, HDR10+, Dolby Vision.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><b>Type</b> </th><th class="markdownTableHeadNone"><b>Color conversion curve name</b>  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SDR </td><td class="markdownTableBodyNone">none  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">HDR </td><td class="markdownTableBodyNone">hlg  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">HDR10/HDR10+ </td><td class="markdownTableBodyNone">st2084(PQ Video)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Dolby Vision（Only IOS support） </td><td class="markdownTableBodyNone">hlg dolby vision（Only IOS support）  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
