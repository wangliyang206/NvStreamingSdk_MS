<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeiCam SDK For Android: Template instructions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MeiCam SDK For Android
   &#160;<span id="projectnumber">3.13.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Template instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Template instructions</h1>
<p>&emsp;&emsp;Meishe template resource package needs to be used by three steps: Installing, catching the template information, setting the timeline. This instruction is only suitable for Android, but IOS need to refer other relevant docs.</p>
<h2>1、Installing</h2>
<p>&emsp;&emsp;Same as other resource package, to call the “install” interface to install which can be finding in the “assetPackageManager”. But template installing must be ** Asynchronous installation, installation completion callback.** </p><pre class="fragment">StringBuilder fx = new StringBuilder();
mStreamingContext.getAssetPackageManager().installAssetPackage(
    “assets:/FD76F889-8093-4757-B0FA-4FAE66273451.template”,
    null,
    NvsAssetPackageManager.ASSET_PACKAGE_TYPE_TEMPLATE,
    false,
    fx);
</pre><h2>2、Setting the template frame percentage (unnecessary step)</h2>
<p>&emsp;&emsp;Template can support multiple pictures. If you want to use non-default picture. It can call “changeTemplateAspectRatio" interface ("assetPackageManage") to set the required template picture: </p><pre class="fragment">public boolean changeTemplateAspectRatio(String uuidString, int aspectRatio)
</pre><p>&emsp;&emsp;The picture percentage supported by the template can be through as “changeTemplateAspectRatio" ("assetPackageManage") interface to check: </p><pre class="fragment">public int getAssetPackageSupportedAspectRatio(String assetPackageId, int type)
</pre><h2>3、Collecting the template information</h2>
<p>&emsp;&emsp;Calling the relevant interface in “assetPackageManager” to gain the template information. It provides a list of materials to get the template from and a list of substitutable captions for template. According to the product needs, it can increase the relevant interface to gain the template information.</p>
<h3>3.1、Collecting template material form:</h3>
<p>&emsp;&emsp;Call “getTemplateFootages” interface, import UUID of the installed template resource package, callback the template material form. </p><pre class="fragment">List&lt;NvsAssetPackageManager.NvsTemplateFootageDesc&gt; list =
m_streamingContext.getAssetPackageManager().getTemplateFootages(templateId);
</pre><p>&emsp;&emsp;Material information: </p><pre class="fragment">public static final int TEIMPLATE_FOOTAGE_TYPE_VIDEO_IMAGE = 0;
public static final int TEIMPLATE_FOOTAGE_TYPE_VIDEO = 1;
public static final int TEIMPLATE_FOOTAGE_TYPE_IMAGE = 2;
public static final int TEIMPLATE_FOOTAGE_TYPE_AUDIO = 3;
public static final int TEIMPLATE_FOOTAGE_TYPE_FAEEZE_FRAME = 4;

public static class NvsTemplateFootageCorrespondingClipInfo 
{
    public int trackIndex;
    public int clipIndex;
    public long inpoint
    public long outpoint
    public boolean needReverse;
    public boolean canReplace;
}

public static class NvsTemplateFootageDesc 
{
    public String id;
    public int type;
    public boolean canReplace;
    public String innerAssetFilePath;
    public ArrayList&lt;String&gt; tags;  
    public ArrayList&lt;NvsTemplateFootageCorrespondingClipInfo&gt; correspondingClipInfos;
}
</pre><h2>3.2、Collecting the template substitutable caption form:</h2>
<p>&emsp;&emsp;Call “getTemplateCaptions” interface, import the UUID of the installed template resource package, callback the template substitutable caption form: </p><pre class="fragment">List&lt;NvsAssetPackageManager.NvsTemplateCaptionDesc&gt; arrayList =
m_streamingContext.getAssetPackageManager().getTemplateCaptions(templateId);
</pre><p>&emsp;&emsp;Caption information: </p><pre class="fragment">public static class NvsTemplateCaptionDesc 
{
    public String replaceId;   //Caption ID
    public String text;       //Text content of Caption
}
</pre><p>&emsp;&emsp;If you need to replace the text content, so need to be traversal timeline’s caption object. Finding the caption object id and “replaced” matched caption object, and then call “setText” to set the text content in caption. </p><pre class="fragment">List&lt;NvsAssetPackageManager.NvsTemplateCaptionDesc&gt; captions = m_streamingContext.getAssetPackageManager().getTemplateCaptions(templateId);

NvsTimelineCaption caption = timeline.getFirstCaption();
while (caption != null) 
{
    String id = caption.getTemplateAttachment(NvsObject.TEMPLATE_KEY_REPLACE_ID);

    if(captions.get(0).replaceId.equals(id)) 
    {
        caption.setText(“test”);
        break;
    }

    caption = m_timeline.getNextCaption(caption);
}
</pre><h2>4、Setting timeline</h2>
<p>&emsp;&emsp;Using the method of “createTimeline” to call “streamingContext”, import the UUID of the installed template resource package, and need to replace “footage” form, callback the Timeline corresponding to the template. </p><pre class="fragment">public NvsTimeline createTimeline(String templateId, List&lt;templateFootageInfo&gt; templateFootages);

public static class templateFootageInfo
{
    public String footageId;        // footage ID
    public String filePath;         // File path corresponding to footage
    public String reverseFilePath;  // Reverse file path corresponding to footage
}
</pre><p>&emsp;&emsp;So far, Application layer can play this timeline, or start a second editing. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
